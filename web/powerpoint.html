<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>Typst for PowerPoint</title>
    <link href="data:image/x-icon;," rel="icon">
    <link href="styles/main.css" rel="stylesheet">
    <link href="styles/file-dropzone.css" rel="stylesheet">
    <link href="styles/status-bar.css" rel="stylesheet">
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  </head>

  <body>
    <div class="controls">
      <div class="control-group">
        <label for="fontSize" title="Font size in points (pt)">Size</label>
        <input id="fontSize" type="number" min="1" step="1.0" value="28">
      </div>
      <div class="control-group checkbox-group fill-color-group">
        <label title="Shape fill color">
          <input id="fillColorEnabled" type="checkbox" checked>
          <span>Fill</span>
        </label>
        <!-- eslint-disable-next-line @html-eslint/use-baseline -->
        <input id="fillColor" type="color" value="#000000">
      </div>
      <div class="control-group checkbox-group">
        <label title="Automatically wrap your input in display math delimiters ($)">
          <input id="mathModeEnabled" type="checkbox" checked>
          <span>Only Math</span>
        </label>
      </div>
    </div>
    <div id="inputWrapper">
      <div id="mathDelimiterTop" class="math-delimiter">$</div>
      <textarea id="typstInput" placeholder="Enter Typst code, e.g. a^2 + b^2 = c^2"></textarea>
      <div id="mathDelimiterBottom" class="math-delimiter">$</div>
    </div>

    <div id="previewContainer">
      <span id="previewLabel">Preview</span>
      <div id="previewContent"></div>
    </div>

    <div id="diagnosticsContainer" style="display: none;">
      <span id="diagnosticsLabel">Diagnostics</span>
      <div id="diagnosticsContent"></div>
    </div>

    <button id="insertBtn" disabled></button>
    <button id="bulkUpdateBtn" style="display: none;">Update font size</button>

    <div class="file-dropzone">
      <div class="dropzone-container">
        <label id="dropzoneLabel" class="dropzone-label"
          alt="Select a Typst file to generate an equation from it">
          <div class="dropzone-icon">üìÅ</div>
          <div class="dropzone-text">Drop a Typst file here</div>
          <div class="dropzone-subtext">or click to browse</div>
          <input id="fileInput" type="file" class="dropzone-input" accept=".typ,.txt">
        </label>

        <div id="fileInfo" class="file-info">
          <div class="file-icon">üìÑ</div>
          <div id="fileName"></div>
        </div>

        <button id="generateFromFileBtn" style="display: none;"></button>
      </div>
    </div>

    <!-- Status Bar -->
    <div id="statusBar" class="status-bar">
      <div id="status" class="status-text"></div>
      <div class="status-bar-controls">
        <button id="themeToggleBtn" class="icon-btn" aria-label="Toggle theme" title="Toggle dark/light mode">
          <svg class="icon-sun" height="18" viewBox="0 0 24 24" width="18">
            <circle cx="12" cy="12" fill="currentColor" r="5" />
            <line
              stroke="currentColor"
              stroke-width="2"
              x1="12"
              x2="12"
              y1="1"
              y2="3"
            />
            <line
              stroke="currentColor"
              stroke-width="2"
              x1="12"
              x2="12"
              y1="21"
              y2="23"
            />
            <line
              stroke="currentColor"
              stroke-width="2"
              x1="4.22"
              x2="5.64"
              y1="4.22"
              y2="5.64"
            />
            <line
              stroke="currentColor"
              stroke-width="2"
              x1="18.36"
              x2="19.78"
              y1="18.36"
              y2="19.78"
            />
            <line
              stroke="currentColor"
              stroke-width="2"
              x1="1"
              x2="3"
              y1="12"
              y2="12"
            />
            <line
              stroke="currentColor"
              stroke-width="2"
              x1="21"
              x2="23"
              y1="12"
              y2="12"
            />
            <line
              stroke="currentColor"
              stroke-width="2"
              x1="4.22"
              x2="5.64"
              y1="19.78"
              y2="18.36"
            />
            <line
              stroke="currentColor"
              stroke-width="2"
              x1="18.36"
              x2="19.78"
              y1="5.64"
              y2="4.22"
            />
          </svg>
          <svg class="icon-moon" height="18" viewBox="0 0 24 24" width="18">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" fill="currentColor" />
          </svg>
        </button>
        <a id="aboutLink" class="about-link" href="#" title="About">About</a>
      </div>
    </div>

    <!-- About Modal -->
    <div id="aboutModal" class="modal">
      <div class="modal-content">
        <button id="aboutModalClose" class="modal-close" aria-label="Close about dialog">
          &times;
        </button>
        <h2>About Typst for PowerPoint</h2>
        <div class="modal-links">
          <a href="https://github.com/splines/typst-powerpoint" rel="noopener noreferrer" target="_blank">
            üåê Visit Website
          </a>
          <a href="https://github.com/splines/typst-powerpoint/issues" rel="noopener noreferrer" target="_blank">
            üêõ Report a Problem
          </a>
          <a href="privacy.html" target="_blank">
            üîí Privacy Policy
          </a>
        </div>
      </div>
    </div>

    <script type="module" defer src="src/main.js"></script>
  </body>

</html>
