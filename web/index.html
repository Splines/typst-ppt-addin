<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="data:image/x-icon;,">
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <style>
        body { margin: 0; padding: 15px; font-family: sans-serif; background: #f4f4f4; min-width: 320px; }
        .controls { display: flex; align-items: center; margin-bottom: 8px; font-size: 13px; color: #444; }
        .controls label { margin-right: 8px; font-weight: 600; }
        .controls input { width: 60px; padding: 4px; border: 1px solid #ccc; border-radius: 4px; }
        textarea { 
            width: 100%; height: 180px; box-sizing: border-box;
            border: 1px solid #ccc; border-radius: 4px; padding: 8px;
            font-family: 'Courier New', monospace; font-size: 14px;
        }
        button { 
            width: 100%; margin-top: 10px; padding: 12px;
            background: #0078d4; color: white; border: none; 
            border-radius: 2px; cursor: pointer; font-weight: bold;
        }
        button:hover { background: #005a9e; }
        button:disabled { background: #aaa; cursor: not-allowed; }
        .footer { margin-top: 20px; font-size: 11px; color: #666; }
        .status { margin-top: 10px; font-size: 12px; color: #444; }
        .status.error { color: #b00020; }
    </style>
</head>
<body>
    <div class="controls">
        <label for="fontSize">Font Size (pt):</label>
        <input type="number" id="fontSize" value="20" min="1" step="0.5" />
    </div>
    <textarea id="typstInput" placeholder="Enter Typst code... e.g. $ a^2 + b^2 = c^2 $"></textarea>
    
    <div id="previewContainer" style="margin-top: 10px; border: 1px dashed #ccc; padding: 10px; min-height: 50px; background: white; text-align: center;">
        <span style="color: #999; font-size: 11px;">Preview</span>
        <div id="previewContent"></div>
    </div>

    <button id="insertBtn" disabled>Loading WASM...</button>
    <div id="status" class="status"></div>
    <div class="footer">Selecting a Typst image on a slide will automatically load its source code here.</div>

    <script type="module" src="script.js"></script>
</body>
</html>
